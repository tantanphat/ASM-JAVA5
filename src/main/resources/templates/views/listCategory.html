<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.w3.org/1999/xhtml" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Estore</title>
    <link rel="shortcut icon" type="image/x-icon" th:href="@{/assets/user/img/favicon.ico}">
    <!--Bootstrap -->
    <link th:href="@{https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css}" rel="stylesheet"
          integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
    <script th:src="@{https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js}"
            integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL"
            crossorigin="anonymous"></script>

    <!-- insert common head -->
    <th:block th:insert="/common/head :: head"></th:block>
    <style>
        .offcanvas-title img {
            width: 8rem;
            height: 8rem;
            border-radius: 50%;
            margin-right: 10px;

        }
        a{
            color:red;
        }
        a:hover{
            color:black;
        }

    </style>
</head>
<body>
<!-- insert common header -->
<div th:insert="~{/common/header :: header}"></div>
<main layout:fragment="index">
    <!-- content-->
<!--    <div class="banner container-fluid p-0">-->
<!--        <div id="demo" class="carousel slide" data-ride="carousel">-->
<!--            <ol class="carousel-indicators">-->
<!--                <li data-target="#demo" data-slide-to="0" class="active"></li>-->
<!--                <li data-target="#demo" data-slide-to="1"></li>-->
<!--                <li data-target="#demo" data-slide-to="2"></li>-->
<!--            </ol>-->
<!--            <div class="carousel-inner">-->
<!--                <div class="carousel-item">-->
<!--                    <img class="d-block w-100" th:src="@{/assets/images/andriyko-podilnyk-F4AMM1293ag-unsplash.jpg}"-->
<!--                         height="800px" alt="Second slide">-->
<!--                </div>-->
<!--                <div class="carousel-item">-->
<!--                    <img class="d-block w-100" th:src="@{/assets/images/pexels-beatrice-cornejo-3989775.jpg}"-->
<!--                         height="800px" alt="Third slide">-->
<!--                </div>-->
<!--            </div>-->
<!--            <a class="carousel-control-prev" href="#demo" role="button" data-slide="prev"> <span-->
<!--                    class="carousel-control-prev-icon" aria-hidden="true"></span> <span class="sr-only">Previous</span>-->
<!--            </a> <a class="carousel-control-next" href="#demo" role="button" data-slide="next"> <span-->
<!--                class="carousel-control-next-icon" aria-hidden="true"></span> <span class="sr-only">Next</span>-->
<!--        </a>-->
<!--        </div>-->
<!--    </div>-->

<!--    <section class="category-area section-padding30" >-->
<!--        <div class="container-fluid">-->
<!--            &lt;!&ndash; Section Tittle &ndash;&gt;-->
<!--            <div class="row">-->
<!--                <div class="col-lg-12">-->
<!--                    <div class="section-tittle text-center mb-85">-->
<!--                        <h2>Shop by Category</h2>-->
<!--                    </div>-->
<!--                </div>-->
<!--            </div>-->
<!--            <div class="row">-->
<!--                <div th:each="danhMucSP : ${danhMucSP}" class="col-xl-4 c   ol-lg-6">-->
<!--                    <div class="single-category mb-30">-->
<!--                        <div class="category-img">-->
<!--                            <img th:src="@{assets/user/img/category/__${danhMucSP.maDM}__.png}" alt="">-->
<!--                            <div class="category-caption">-->
<!--                                <h2 th:text="${danhMucSP.tenDanhMuc}">Category Name</h2>-->
<!--                                <span class="best"><a href="#">Best New Deals</a></span>-->
<!--                                <span class="collection">New Collection</span>-->
<!--                            </div>-->
<!--                        </div>-->
<!--                    </div>-->
<!--                </div>-->
<!--            </div>-->
<!--        </div>-->
    <!--             Nav Card -->
    <h1>Sản phẩm theo danh mục</h1>
    <div class="tab-content" id="nav-tabContent">
        <!-- card one -->
        <div class="tab-pane fade show active" id="nav-home"
             role="tabpanel" aria-labelledby="nav-home-tab">
            <div class="row" id="product-container">
                <!-- Sản phẩm sẽ được hiển thị ở đây -->
            </div>
        </div>
    </div>

    <script>
        $(document).ready(function() {
            // Lấy tham số maDM từ URL
            var urlParams = new URLSearchParams(window.location.search);
            var categoryID = urlParams.get('maDM');

            if (categoryID) {
                // Địa chỉ API để gọi
                var apiUrl = 'http://localhost:8080/api/san-pham/danh-muc-sp/' + categoryID;

                // Thực hiện AJAX call
                $.ajax({
                    url: apiUrl,
                    type: 'GET',
                    success: function(data) {
                        // Hàm được gọi khi request thành công
                        // data chứa danh sách sản phẩm từ server
                        renderProducts(data); // Gọi hàm renderProducts để hiển thị sản phẩm
                    },
                    error: function(error) {
                        // Hàm được gọi khi request thất bại
                        console.error('Lỗi khi gọi API:', error);
                    }
                });
            }

            // Hàm để hiển thị sản phẩm
            function renderProducts(products) {
                var productsContainer = $('#product-container'); // Chọn container để chứa sản phẩm
                productsContainer.empty(); // Xóa nội dung hiện có trong container

                // Lặp qua danh sách sản phẩm và tạo phần tử HTML cho mỗi sản phẩm
                products.forEach(function(product) {
                    var productHTML = `
                        <div class="col-xl-4 col-lg-4 col-md-6">
                            <div class="single-product mb-60">
                                <div class="product-img">
                                    <img src="/assets/sanpham/${product.anh}" alt="${product.tenSP}">
                                    <div class="new-product">
                                        <span>New</span>
                                    </div>
                                </div>
                                <div class="product-caption">
                                    <div class="product-ratting">
                                        <i class="far fa-star"></i> <i class="far fa-star"></i> <i class="far fa-star"></i> <i class="far fa-star low-star"></i>
                                        <i class="far fa-star low-star"></i>
                                    </div>
                                    <h4><a href="/product?maSP=${product.maSP}">${product.tenSP}</a></h4>
                                    <div class="price">
                                        <ul>
                                            <li>${product.giaBan}</li>
                                            <li class="discount">$60.00</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `;

                    // Thêm sản phẩm vào container
                    productsContainer.append(productHTML);
                });
            }
        });
    </script>
</body>
</html>

        <div th:replace="/common/footer :: footer"></div>
            <div th:fragment="introduce">
                <!-- introduce content here -->
    </div>

</main>
</body>
</html>>